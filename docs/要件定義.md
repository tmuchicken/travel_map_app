# 旅行経路アニメーション生成Webアプリ 要件定義書 (v6)

## 1. 概要

ユーザーが旅行の出発地から目的地までの経路を地図上にアニメーションで表示し、バス・飛行機・電車などの移動手段に応じたアイコンを使って動画風に表現できる、日本語対応のWebアプリケーションを開発する。

## 2. 対象ユーザー

* 旅行Vlog・旅行記の作成者
* 観光関連のSNS投稿者
* 日本語を主とする一般ユーザー

## 3. 機能要件

### 3.1 地図表示
* OpenStreetMap を利用したインタラクティブマップの表示
* 日本語ラベル対応

### 3.2 経路入力と移動手段設定
* **UI統合:** 経路入力と各区間の移動手段選択を同一のインターフェースで行う。
* **出発地・目的地の入力:** 住所または地名で入力。
* **中継地点の追加:** 複数地点を経由可能。
    * 出発地入力後、次の地点（最初の中継地または目的地）までの移動手段を選択するUIを表示。
    * 中継地点を追加するごとに、その地点の入力欄と、その地点から次の地点（次の中継地または目的地）への移動手段を選択するUIをセットで表示。
* **移動手段の選択（アイコン付き）:**
    * バス 🚌
    * 飛行機 ✈️
    * 電車 🚆
    * 車 🚗
    * 船 ⛴
    * 徒歩 🚶‍♂️
* **入力補完（サジェスト）機能:** あり（ジオコーディングサービスを利用）。

### 3.3 (旧3.3 移動手段選択は 3.2 に統合)

### 3.4 アニメーション再生
* **UI配置:** アニメーション操作パネル（再生・停止ボタン、速度調整スライダーなど）は、地図表示エリアの近く（例: 地図の下など）に配置し、ユーザーが地図を確認しながら操作しやすいようにする。
* 出発地と目的地にピン刺しをして、地名を表示。
* 経路上をアイコンがアニメーションで移動。
* **陸上交通（バス、車、徒歩など）は、実際の道路網に基づいた経路でアニメーション表示。**
* **飛行機や船など、特定の経路に縛られない移動手段は、出発地と目的地（または中継地）間を直線または曲線でアニメーション表示。**
* アニメーション速度の調整（スライダー形式）。
* 地図の自動スクロール・ズームイン。

### 3.5 出力機能
* 再生中アニメーションの録画（動画ファイルとしてエクスポート、最大4K画質を目標とする）
* 画像としてスクリーンショット保存
* SNS向けの共有機能（MP4、GIF形式）

### 3.6 ユーザーインターフェース
* 日本語UI（全項目）
* モバイル対応（レスポンシブデザイン）
* ダークモード切替機能

### 3.7 保存・読み込み機能
* プロジェクトのローカルストレージへの一時保存と再編集

## 4. 非機能要件

* **対応ブラウザ：** Chrome、Safari、Edge、Firefox（最新バージョン）
* **対応言語：** 日本語（初期対応）、多言語化（将来的に）
* **フロントエンド：** React または Vue.js（SPA構成）
* **地図API：** Leaflet.js + OpenStreetMap、または Google Maps API
* **経路検索 (ルーティング) およびジオコーディング:**
    * OpenStreetMap利用時:
        * **ルーティングエンジン:** `Leaflet Routing Machine` (クライアントサイド) や OSRM (Open Source Routing Machine) などの利用を検討。これにより実際の道路に基づいた経路探索が可能。
        * **ジオコーディングサービス:** Nominatim (OpenStreetMapの無料ジオコーディングサービス) などの利用を検討。
    * Google Maps API利用時: Google Maps Platformの各種サービスを利用。
* **ホスティング:** **Vercel** を利用。
    * フロントエンドアプリケーションのデプロイに特化。
    * GitHubなどのリポジトリと連携したCI/CD機能。
    * サーバーレス関数 (Vercel Functions) のサポート。
    * 無料利用枠あり。
* **経路検索APIなどをサーバーサイドで処理する場合（必要に応じて）：** Vercel Functions またはその他のサーバーレス環境 (Node.js + Expressなど) を検討（APIキーの秘匿化、リクエスト制限対策など）

## 5. 管理機能（将来的に検討）

* テンプレート保存・公開機能（ローカルまたは共有可能な形式でのエクスポート/インポートを検討）
* 利用履歴管理（ローカルでの簡易的なものを検討）

## 6. 制約事項

* Google Maps API使用時は商用利用の課金制に注意
* 録画機能はブラウザベースで制限あり（MediaRecorder API 使用）。特に高画質（4Kなど）での録画は、ユーザーのPC環境やブラウザの性能に大きく依存し、処理時間や安定性に影響が出る可能性がある。
* 無料の経路検索APIやジオコーディングサービスには利用規約（リクエスト頻度制限など）があるため注意が必要。
* 4K動画出力時のファイルサイズは非常に大きくなるため、ユーザーのストレージ容量や共有時のアップロード/ダウンロード時間に影響を与える可能性がある。

## ❓ 作成前に確認したことへの回答

* **ターゲット利用者:** 個人利用を前提とします。
* **動画出力の画質要件:** 最大4Kを想定します。ただし、高画質出力には以下の留意点があります。
    * **処理負荷と時間:** 4K動画のエンコードは非常に処理負荷が高く、ブラウザベースでの実現には時間がかかる可能性があります。特にユーザーのPCスペックに大きく依存します。
    * **ファイルサイズ:** 4K動画はファイルサイズが非常に大きくなるため、保存や共有に影響が出る可能性があります。（制約事項にも追記）
    * **ブラウザの制約:** `MediaRecorder API` の対応状況やパフォーマンスはブラウザによって異なり、安定して4K録画を実現するには技術的な検証が必要です。（制約事項にも追記）
* **アイコンデザイン:** 既存素材を利用する予定です。
* **商用利用:** 現時点では予定していません。
* **SNS連携:** 現時点では不要です。
